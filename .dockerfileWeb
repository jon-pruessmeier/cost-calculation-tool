FROM node:18-alpine as builder
WORKDIR /app

COPY . .

RUN npm install

RUN npm i -g nx

RUN nx build web



FROM node:18-alpine

WORKDIR /app

COPY --from=builder /app/dist/packages/web .

RUN npm install --production

EXPOSE 3000

CMD ["npm", "start"]